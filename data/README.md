# This folder contains datasets generated by the repository.

## Implementing DTox visible neural network model on compound target binding-Tox21 assay outcome datasets 

+ First, hyperparameter tuning of DTox model was performed to find the optimal setting for each of the 15 Tox21 datasets. DTox model has three hyperparameters (listed below). Altogether, 90 hyperparameter combinations were implemented on each dataset. Model performance was measured using binary cross-entropy (BCE) loss, area under ROC curve (AUROC), balanced accuracy, and F1 score. Details about model statistics and performance can be found [here](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_performance_summary.tsv). The three hyperparameters are:   
  + minimal size of pathways included in DTox model ('ps', values for implementation: 5, 20)
  + root pathway combinations ('rt', values for implementation: 'gene expression', 'immune system', 'metabolism', 'signal transduction' and all possible combinations of the four pathways, 15 in total)
  + coefficient for auxiliary loss in loss function ('al', values for implementation: 0.1, 0.5, 1)

+ Next, training BCE loss was employed to identify the optimal hyperparameter setting for each dataset (see [optimal model statistics](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_model_parameter_summary.tsv) and [optimal model performance](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv)). Model performance was also [normalized](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_rt_training_root_loss_normalized_comparison_by_dataset.tsv) to enable comparison of root pathway settings across Tox21 datasets.

+ Finally, validation performance of optimal DTox visible neural network model ([VNN](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv)) was compared against [four other method implementations](compound_target_probability_tox21_implementation/compound_target_probability_tox21_compare_files.tsv):
  + alternative DTox visible neural network model with the same setting as optimal model but built under shuffled Reactome pathway hierarchy ([VNN-S](compound_target_probability_tox21_shuffle/compound_target_probability_tox21_shuffle_performance_summary.tsv))
  + fully connected multi-layer perceptron neural network model, otherwise with the same number of hidden layer/neuron as the matched DTox model ([MLP](compound_target_probability_tox21_mlp/compound_target_probability_tox21_mlp_fully_connected_performance_summary.tsv)) 
  + optimal random forest model after hyperparameter tuning ([RF](compound_target_probability_tox21_simple/randomforest/compound_target_probability_tox21_simple_randomforest_optimal_performance_summary_by_training_log_loss.tsv), full results before tuning can be found [here](compound_target_probability_tox21_simple/randomforest/compound_target_probability_tox21_simple_randomforest_performance_summary.tsv))
  + optimal gradient boosting model after hyperparameter tuning ([GB](compound_target_probability_tox21_simple/xgboost/compound_target_probability_tox21_simple_xgboost_optimal_performance_summary_by_training_log_loss.tsv), full results before tuning can be found [here](compound_target_probability_tox21_simple/xgboost/compound_target_probability_tox21_simple_xgboost_performance_summary.tsv))

## Implementing DTox visible neural network model on compound target binding-Tox21 assay outcome datasets 

+ First, hyperparameter tuning of LRP rule was performed to test the influence of two hyperparameters (γ and ε) on model interpretation results of 15 Tox21 dataset of 15 Tox21 datasets. Three values (0.1, 0.01, 0.001) were appied to each hyperparameter. In total, nine hyperparameter combinations of γ and ε were implemented on the DTox model built upon each dataset. As a result, significant DTox paths were generated as part of the model interpretation output. Jaccard Index was employed to measure [the similarity of significant DTox paths detected under different hyperparameter settings](compound_target_probability_tox21_interpret_analysis/compound_target_fingerprint_maccs_probability_gamma-epsilon_path_similarity.tsv).  
