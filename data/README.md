# This folder contains datasets generated by the repository.

## Implementing DTox visible neural network model on compound target binding-Tox21 assay outcome datasets 

+ First, hyperparameter tuning of DTox model was performed to find the optimal setting for each of the 15 Tox21 datasets. DTox model has three hyperparameters (listed below). Altogether, 90 hyperparameter combinations were implemented on each dataset. Model performance was measured using binary cross-entropy (BCE) loss, area under ROC curve (AUROC), balanced accuracy, and F1 score. Details about model statistics and performance can be found [here](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_performance_summary.tsv). The three hyperparameters are:   
  + minimal size of pathways included in DTox model ('ps', values for implementation: 5, 20)
  + root pathway combinations ('rt', values for implementation: 'gene expression', 'immune system', 'metabolism', 'signal transduction' and all possible combinations of the four pathways, 15 in total)
  + coefficient for auxiliary loss in loss function ('al', values for implementation: 0.1, 0.5, 1)

+ Next, training BCE loss was employed to identify the optimal hyperparameter setting for each dataset (see [optimal model statistics](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_model_parameter_summary.tsv) and [optimal model performance](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv)). Model performance was also [normalized](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_rt_training_root_loss_normalized_comparison_by_dataset.tsv) to enable comparison of root pathway settings across Tox21 datasets.

+ Finally, validation performance of optimal DTox visible neural network model ([VNN](compound_target_probability_tox21_implementation/compound_target_probability_tox21_implementation_optimal_performance_summary_by_training_root_loss.tsv)) was compared against [four other method implementations](compound_target_probability_tox21_implementation/compound_target_probability_tox21_compare_files.tsv):
  + alternative DTox visible neural network model with the same setting as optimal model but built under shuffled Reactome pathway hierarchy ([VNN-S](compound_target_probability_tox21_shuffle/compound_target_probability_tox21_shuffle_performance_summary.tsv))
  + fully connected multi-layer perceptron neural network model, otherwise with the same number of hidden layer/neuron as the matched DTox model ([MLP](compound_target_probability_tox21_mlp/compound_target_probability_tox21_mlp_fully_connected_performance_summary.tsv)) 
  + optimal random forest model after hyperparameter tuning ([RF](compound_target_probability_tox21_simple/randomforest/compound_target_probability_tox21_simple_randomforest_optimal_performance_summary_by_training_log_loss.tsv), full results before tuning can be found [here](compound_target_probability_tox21_simple/randomforest/compound_target_probability_tox21_simple_randomforest_performance_summary.tsv))
  + optimal gradient boosting model after hyperparameter tuning ([GB](compound_target_probability_tox21_simple/xgboost/compound_target_probability_tox21_simple_xgboost_optimal_performance_summary_by_training_log_loss.tsv), full results before tuning can be found [here](compound_target_probability_tox21_simple/xgboost/compound_target_probability_tox21_simple_xgboost_performance_summary.tsv))

## Implementing LRP rule to interpret optimal DTox models of compound target binding-Tox21 assay outcome datasets  

+ First, hyperparameter tuning of LRP rule was performed to test the influence of two hyperparameters (γ and ε) on model interpretation results of 15 Tox21 dataset of 15 Tox21 datasets. Three values (0.1, 0.01, 0.001) were applied to each hyperparameter. In total, nine hyperparameter combinations of γ and ε were implemented on the DTox model built upon each dataset. As a result, significant DTox paths were generated as part of the model interpretation output. Jaccard Index was employed to measure [the similarity of significant DTox paths detected under different hyperparameter settings](compound_target_probability_tox21_interpret_analysis/compound_target_fingerprint_maccs_probability_gamma-epsilon_path_similarity.tsv). 

+ Next, the identified significant DTox paths were validated using gene expression data after perturbation from LINCS. Specifically, a DTox path is considered differentially expressed if pathways along the path were significantly enriched with differentially expressed genes after perturbation of the matched compound. The validation scheme was implemented on significant DTox paths identified under nine different hyperparameter combinations of LRP propagation, and six dose-time combination (1.11uM-6h, 1.11uM-24h, 10uM-6h, 10uM-24h, 20uM-6h, 20uM-24h) of LINCS perturbation data. The proportion of differentially expressed DTox paths among significant DTox paths and all background paths were [computed for each compound under the instances](compound_target_probability_tox21_interpret_expression/validation_summary/compound_target_fingerprint_maccs_probability_tox21_interpret_expression_validation_all_result.tsv) and [compared within each Tox21 assay using t test](compound_target_probability_tox21_interpret_expression/validation_summary/compound_target_fingerprint_maccs_probability_tox21_interpret_expression_validation_result_compare_summary.tsv). In addition, differentially expressed DTox paths that recurrently appear across different compounds were [identified for each Tox21 assay](compound_target_probability_tox21_interpret_expression/validation_summary/gamma-epsilon_0.001_0.1_expression_validation_sig_path_recurrent.tsv). 

+ Then, the identified significant DTox paths were validated using standard pathway-receptor pattern of path. Specifically, a compound is considered to be validated if at least one significant DTox path contains the matched standard pathway-receptor pattern. The validation scheme was implemented on significant DTox paths identified under nine different hyperparameter combinations of LRP propagation. The expected probability and observed outcome of finding at least one standard path among the significant DTox paths were [computed for four assays of interest (AR, ER, RAR, ROR) under each hyperparameter combination](compound_target_probability_tox21_interpret_standard/validation_summary/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_all_result.tsv). Based on the results, the [observed proportion of validated compounds](compound_target_probability_tox21_interpret_standard/validation_summary/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_result_compare_summary.tsv) and [expected proportion of validated compounds](compound_target_probability_tox21_interpret_standard/validation_summary/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_bg_sample.tsv) were computed.

+ At last, the significant DTox paths identified for compounds in the HepG2 cell viability dataset were analyzed n the context of two viability-related Tox21 assays ([CASP3/7 apoptosis assay](compound_target_probability_tox21_interpret_viability/compound_target_fingerprint_maccs_probability_tox21-rt-viability-hepg2-p1_whole_data.tsv_rt_25_ps_5_re_0_xs_20_al_0.5_ld_0.0001_model.pt_gamma-epsilon_0.001_0.1_pathway_module_compare_tox21-casp3-hepg2-p1.tsv) and [mitochondria toxicity assay](compound_target_probability_tox21_interpret_viability/compound_target_fingerprint_maccs_probability_tox21-rt-viability-hepg2-p1_whole_data.tsv_rt_25_ps_5_re_0_xs_20_al_0.5_ld_0.0001_model.pt_gamma-epsilon_0.001_0.1_pathway_module_compare_tox21-mitotox-p1.tsv)). The analysis was focused on [nine viability-related Reactome pathways](compound_target_probability_tox21_interpret_viability/tox21-rt-viability-hepg2_pathways.tsv). Specifically, the DTox pathway module relevance scores were compared between active and inactive compounds of each assay using log-rank test. 

## Implementing trained DTox visible neural network model to predict cell viability assay outcomes of 708,409 DSSTox compounds 

+ The optimal DTox models of HepG2 and HEK293 viability were implemented to predict the cytotoxicity probability of 708,409 DSSTox compounds. Further analysis was conducted on [the predicted HepG2 cytotoxicity probability for compounds associated drug-induced liver (DILI) injury phenotypes](compound_target_probability_tox21_prediction/rt-viability-hepg2-p1/dili_phenotype_tox21-rt-viability-hepg2-p1_dsstox_compound_model_pred_score.tsv), and on [the predicted HEK293 cytotoxicity probability for compounds associated drug-induced kidney injury (DIKI) phenotypes](compound_target_probability_tox21_prediction/rt-viability-hek293-p1/diki_phenotype_tox21-rt-viability-hek293-p1_dsstox_compound_model_pred_score.tsv). Specifically, wilcoxon test was performed to compare the predicted cytotoxicity probability between positive and negative DSSTox compounds associated with [DILI phenotypes](compound_target_probability_tox21_prediction/rt-viability-hepg2-p1/dili_phenotype_tox21-rt-viability-hepg2-p1_dsstox_compound_model_pred_score_compare.tsv) or [DIKI phenotypes](compound_target_probability_tox21_prediction/rt-viability-hek293-p1/diki_phenotype_tox21-rt-viability-hek293-p1_dsstox_compound_model_pred_score_compare.tsv). 
