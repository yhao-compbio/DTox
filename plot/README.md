# This folder contains figures generated by the repository

## Visualize DTox visible neural network model training, performance, and comparison with other methods   

+ First, the evolution of training/testing loss over epoches during DTox learning process was visualized using [line charts](compound_target_probability_tox21_implementation/training_loss/) for each dataset. Overall, the optimal DTox model can be reached within 100-200 epoches for the implementation task on Tox21 datasets. After the optimal point, training loss keeps decreasing while testing loss remains fluctuant or increases.    

+ Next, model statistics of optimal DTox and matched matched multi-layer perceptron (MLP) were visualized using [barplots](compound_target_probability_tox21_implementation/parameter_comparison/) for each dataset. On average, an optimal DTox visible neural network model contains ~400 hidden pathway modules and ~40,000 learned weight parameter. The average ratio between training samples and number of DTox parameters is ~0.15, ~40 times of the average ratio for VNN parameters.

+ Then, normalized DTox model performance of Tox21 datasets across root pathway settings were visualized using [heatmap](compound_target_probability_tox21_implementation/hyperparameter_comparison/compound_target_probability_tox21_implementation_rt_training_root_loss_normalized_comparison_by_dataset.pdf) and [upsetplot](compound_target_probability_tox21_implementation/hyperparameter_comparison/compound_target_probability_tox21_implementation_rt_upset.pdf). The optimal root pathway setting varies by dataset. Overall, including more pathways in the root of DTox visible neural network results in better model performance. 

+ Finally, validation performance of DTox visible neural network model (VNN) was compared against other method implementations. The comparison was visualized using [barplots](compound_target_probability_tox21_implementation/method_comparison/) for each dataset. Four other method implementations were considered: i) alternative DTox visible neural network model with the same setting as optimal model but built under shuffled Reactome pathway hierarchy (VNN-S), ii) fully connected MLP neural network model, otherwise with the same number of hidden layer/neuron as the matched DTox model (MLP), iii) optimal random forest model after hyperparameter tuning (RF), and iv) optimal gradient boosting model after hyperparameter tuning (GB).

## Visualize DTox visible neural network model interpretation 

+ First, the similarity of significant DTox paths under different hyperparameter settings of layer-wise relevance propagation rule was visualized using [heatmap](compound_target_probability_tox21_interpret_analysis/compound_target_fingerprint_maccs_probability_gamma-epsilon_path_similarity.pdf). The heatmap shows an average summary across results on 15 Tox21 datasets. Overall, the hyperparameter setting does not have strong influence on the detected significant DTox paths. The median Jaccard Index among hyperparameter settings is ~0.7. 

+ Next, the comparison between proportion of differentially expressed DTox paths among significant DTox paths vs all background paths was visualized using [scatterplot](compound_target_probability_tox21_interpret_expression/compound_target_fingerprint_maccs_probability_tox21_interpret_expression_validation_result_compare_gamma-epsilon_0.001_0.1.pdf). The scatterplot shows the comparison for significant DTox paths identified using γ = 0.001 and Ɛ = 0.1. Comparison was shown separately for results from four Tox21 assays (from left to right: aromatase, mitochondria toxicity, PXR agonist, HepG2 cell viability) and three dose-time combinations (from top to bottom 10uM-6h, 10um-24h, 1.11-24uM). The differentially expressed DTox paths that recurrently appear across compounds in aromatase assay were visualized using [barplot](compound_target_probability_tox21_interpret_expression/gamma-epsilon_0.001_0.1_expression_validation_sig_path_recurrent_tox21-aromatase-p1_5.pdf).  

+ Then, the comparison between observed and expected proportion of validated compounds was visualized using [density plots and barplots](compound_target_probability_tox21_interpret_standard/). Each plot shows the comparison for significant DTox paths identified using γ = 0.001 and Ɛ = 0.1. Comparison was shown separately for results from four Tox21 assays: [AR](compound_target_probability_tox21_interpret_standard/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_result_compare_gamma-epsilon_0.001_0.1_tox21-ar-mda-kb2-luc-antagonist-p2.pdf), [ER](compound_target_probability_tox21_interpret_standard/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_result_compare_gamma-epsilon_0.001_0.1_tox21-er-luc-bg1-4e2-agonist-p2.pdf), [RAR](compound_target_probability_tox21_interpret_standard/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_result_compare_gamma-epsilon_0.001_0.1_tox21-rar-antagonist-p2.pdf), and [ROR](compound_target_probability_tox21_interpret_standard/compound_target_fingerprint_maccs_probability_tox21_interpret_standard_validation_result_compare_gamma-epsilon_0.001_0.1_tox21-ror-cho-antagonist-p1.pdf). In each plot, the density plot on top shows the distribution of sampled expected proportions while the barplot on bottom shows the comparison between observed and expected proportion. 
